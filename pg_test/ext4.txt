df -hT /mnt/ext4/; pg_test_fsync -f /mnt/ext4/pgtest -s 10
Filesystem     Type  Size  Used Avail Use% Mounted on
/dev/sda4      ext4   77G  1.1G   72G   2% /mnt/ext4
10 seconds per test
O_DIRECT supported on this platform for open_datasync and open_sync.

Compare file sync methods using one 8kB write:
(in wal_sync_method preference order, except fdatasync
is Linux's default)
        open_datasync                    1726.870 ops/sec
        fdatasync                        1725.666 ops/sec
        fsync                            1709.996 ops/sec
        fsync_writethrough                            n/a
        open_sync                        1711.462 ops/sec

Compare file sync methods using two 8kB writes:
(in wal_sync_method preference order, except fdatasync
is Linux's default)
        open_datasync                     862.464 ops/sec
        fdatasync                         874.681 ops/sec
        fsync                            1225.732 ops/sec
        fsync_writethrough                            n/a
        open_sync                        1214.016 ops/sec

Compare open_sync with different write sizes:
(This is designed to compare the cost of writing 16kB
in different write open_sync sizes.)
         1 * 16kB open_sync write        1316.478 ops/sec
         2 *  8kB open_sync writes       1270.661 ops/sec
         4 *  4kB open_sync writes       1101.478 ops/sec
         8 *  2kB open_sync writes        143.918 ops/sec
        16 *  1kB open_sync writes         54.669 ops/sec

Test if fsync on non-write file descriptor is honored:
(If the times are similar, fsync() can sync data written
on a different descriptor.)
        write, fsync, close              1721.948 ops/sec
        write, close, fsync              1721.231 ops/sec

Non-Sync'ed 8kB writes:
        write                           92115.625 ops/sec
